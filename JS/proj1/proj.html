<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Mulish&family=Open+Sans:ital,wght@0,300;0,600;1,300&family=Press+Start+2P&display=swap"
        rel="stylesheet">
</head>
<style>
    @font-face {
        font-family: 'PressStart2P-Regular';
        font-weight: 300;

        src: url('fonts/PressStart2P-Regular.ttf');
    }

    body {
        margin: 0px;
        padding: 0px;
        box-sizing: border-box;
    }

    .cube {
        width: 100px;
        height: 100px;
        background-image: url('pics/NicePng_spaceship-png_138961.png');
        position: relative;
        z-index: 100;
        background-size: contain;
        background-repeat: no-repeat;
        overflow: hidden;

    }

    .playfield {
        width: 100vw;
        height: 100vh;
        background-image: url('pics/885542.png');
        background-size: cover;
        background-repeat: no-repeat;
        position: absolute;

    }

    #bot_shot {
        position: fixed;
        width: 6px;
        height: 10px;
        background-color: rgb(0, 247, 0);
        border-radius: 40%;
        box-sizing: border-box;
        padding: 2px 0px 0px 2px;
        ;
    }

    #bot_shot_inner {
        position: fixed;
        width: 2px;
        height: 6px;
        background-color: rgb(157, 255, 0);
        border-radius: 40%;
        box-sizing: border-box;
    }

    #npc_shot {
        position: fixed;
        width: 6px;
        height: 10px;
        background-color: rgb(255, 0, 0);
        border-radius: 40%;
        box-sizing: border-box;
        padding: 2px 0px 0px 2px;
        ;
    }

    #npc_shot_inner {
        position: fixed;
        width: 2px;
        height: 6px;
        background-color: rgb(148, 0, 0);
        border-radius: 40%;
        box-sizing: border-box;
    }

    #bot {
        position: fixed;
        width: 80px;
        height: 80px;
        background-image: url('pics/images__1_-removebg-preview.png');
        background-repeat: no-repeat;
        background-size: cover;
        top: -100px;
        left: 0px;
        padding: 0px;
    }

    #bot_hp {
        width: 70px;
        height: 10px;
        margin: -10px 0px 0px 5px;
        background-color: red;
        border-color: white;
        border-width: 1px;
        border-style: solid;
    }

    .outerlevel {
        width: 260px;
        height: 70px;
        background-color: rgb(99, 99, 99);
        position: fixed;
        bottom: 0px;
        border-radius: 10%;
        border-color: rgb(59, 59, 59);
        border-width: 2px;
        border-style: solid;
        box-sizing: border-box;
    }

    .innerlevel {
        box-sizing: border-box;
        width: 240px;
        height: 50px;
        background-color: rgb(59, 59, 59);
        position: fixed;
        bottom: 0px;
        border-radius: 10%;
        margin: 0px 0px 10px 10px;
        font-size: 27px;
        padding-left: 0px;
        padding-top: 11px;
        font-weight: 300;
        font-family: 'PressStart2P-Regular';



    }

    .pausewindow {
        width: 100vw;
        height: 100vw;
        background-color: rgba(0, 0, 0, 0.541);
        display: none;
        position: fixed;
        z-index: 1000;
    }

    .unpouse_button {
        height: 20vh;
        width: 30vw;
        position: fixed;
        left: 35vw;
        top: 10vh;
        border-radius: 10%;
        font-size: 57px;
        padding-left: 0px;
        padding-top: 11px;
        font-weight: 300;
        font-family: 'PressStart2P-Regular';
        color: black;
    }

    .unpouse_button:hover {
        background-color: rgb(156, 156, 156);
    }

    #player_hp {}
</style>

<body>
    <div class="pausewindow">
        <input type="button" name="" value="resume" class="unpouse_button">
    </div>
    <div class="playfield">
        <div class="outerlevel">
            <div class="innerlevel">
                level 0
            </div>
        </div>
        <div class="cube">
            <div id="player_hp"></div>
        </div>
    </div>

</body>

</html>
<script>
    let mouseCurPos = null, last_bot_xpos = 0, cicleKost = false, player_hero = document.querySelector('.cube'), bot_diff = 0, timer_Npc_spawn = null, outerLVL = document.querySelector('.outerlevel'), LVLno = 1, pausediffInterval = null, pauseInterval, pauseMouseInterval = null, pausewindow = document.querySelector('.pausewindow'), paused = false, playField = document.querySelector('.playfield'), diffTime = 0, timeouts = null, filler = null, timer = null, timer1 = null, timer_npc_shot = null, shottime = 0, shotfiller = null,timer_npc_shot1=null;
    //let timerShot = setInterval(() => alert("ничего не происходит"), 100);//

    function bot_simple_attack() {
        let bot_shot = document.createElement('div');
        bot_shot.id = "bot_shot";
        let bot_shot_start_posX = parseInt(player_hero.style.left) + 48 + 'px', bot_shot_start_posY = player_hero.style.top;
        bot_shot.style.left = bot_shot_start_posX;
        bot_shot.style.top = bot_shot_start_posY;
        let bot_shotin = document.createElement('div');
        bot_shotin.id = "bot_shot_inner";
        bot_shot.appendChild(bot_shotin);
        const currentdiv = player_hero;
        const playfield = playField;
        playfield.insertBefore(bot_shot, currentdiv);


    }
    function bot_spawn() {
        if (!paused) {
            let bot_spawn = document.createElement('div');
            bot_spawn.id = "bot";
            let bot_spawn_xpos = Math.random() * (window.innerWidth - 80), bot_spawn_ypos = -100;
            bot_spawn.style.left = bot_spawn_xpos + 'px';
            bot_spawn.style.top = bot_spawn_ypos + 'px';
            let bot_hp = document.createElement('div');
            bot_hp.id = "bot_hp";
            bot_hp.style.cssText = "width:70px; heigth:10px;margin: -10px 0px 0px 5px;background-color: red;border-color: white;border-width: 1px;border-style: solid;";
            bot_spawn.appendChild(bot_hp);
            const currentdiv = player_hero;
            const playfield = playField;
            playfield.insertBefore(bot_spawn, currentdiv);

            console.log('bot_spawned')
        }


    }
    function npc_shooting() {
        if (!paused) {
            npcs = document.querySelectorAll('#bot')

            for (i = 0; i < npcs.length; i++) {
                console.log('shot');
                let npc_shot = document.createElement('div');
                npc_shot.id = "npc_shot";
                let npc_shot_start_posX = parseInt(npcs[i].style.left) + 38 + 'px', npc_shot_start_posY = parseInt(npcs[i].style.top) + 60 + 'px';
                npc_shot.style.left = npc_shot_start_posX;
                npc_shot.style.top = npc_shot_start_posY;
                let npc_shotin = document.createElement('div');
                npc_shotin.id = "npc_shot_inner";
                npc_shot.appendChild(npc_shotin);
                const currentdiv = outerLVL;
                const playfield = playField;
                playfield.insertBefore(npc_shot, currentdiv);
            }
        }

    }
    function playerAttack() {
        if (!paused) {
            for (let i = 0; i < document.querySelectorAll('#bot_shot').length; i++) {
                document.querySelectorAll('#bot_shot')[i].style.top = parseInt(document.querySelectorAll('#bot_shot')[i].style.top) - 2 + 'px';
                for (let k = 0; k < document.querySelectorAll('#bot').length; k++) {
                    if (parseInt(document.querySelectorAll('#bot')[k].style.top) + 72 >= parseInt(document.querySelectorAll('#bot_shot')[i].style.top) && parseInt(document.querySelectorAll('#bot')[k].style.top) <= parseInt(document.querySelectorAll('#bot_shot')[i].style.top) && (parseInt(document.querySelectorAll('#bot')[k].style.left) <= parseInt(document.querySelectorAll('#bot_shot')[i].style.left) + 3 && parseInt(document.querySelectorAll('#bot')[k].style.left) + 76 >= parseInt(document.querySelectorAll('#bot_shot')[i].style.left))) {

                        cicleKost = true;

                        if (parseInt(document.querySelectorAll('#bot_hp')[k].style.width) == 10) {
                            document.querySelectorAll('#bot_hp')[k].style.width = 0 + 'px';
                            document.querySelectorAll('#bot')[k].remove();
                            break;
                        }
                        if (parseInt(document.querySelectorAll('#bot_hp')[k].style.width) == 20) {
                            document.querySelectorAll('#bot_hp')[k].style.width = 10 + 'px';
                        }
                        if (parseInt(document.querySelectorAll('#bot_hp')[k].style.width) == 30) {
                            document.querySelectorAll('#bot_hp')[k].style.width = 20 + 'px';
                        }
                        if (parseInt(document.querySelectorAll('#bot_hp')[k].style.width) == 40) {
                            document.querySelectorAll('#bot_hp')[k].style.width = 30 + 'px';
                        }
                        if (parseInt(document.querySelectorAll('#bot_hp')[k].style.width) == 50) {
                            document.querySelectorAll('#bot_hp')[k].style.width = 40 + 'px';
                        }
                        if (parseInt(document.querySelectorAll('#bot_hp')[k].style.width) == 60) {
                            document.querySelectorAll('#bot_hp')[k].style.width = 50 + 'px';

                        }
                        if (parseInt(document.querySelectorAll('#bot_hp')[k].style.width) == 70) {
                            document.querySelectorAll('#bot_hp')[k].style.width = 60 + 'px';

                        }

                        break;
                    }
                }
                if (cicleKost == true) {
                    document.querySelectorAll('#bot_shot')[i].remove();

                    cicleKost = false;
                } else {
                    if (parseInt(document.querySelectorAll('#bot_shot')[i].style.top) <= -30) {
                        document.querySelectorAll('#bot_shot')[i].remove();
                    }
                }


            }
            for (let d = 0; d < document.querySelectorAll('#npc_shot').length; d++) {
                document.querySelectorAll('#npc_shot')[d].style.top = parseInt(document.querySelectorAll('#npc_shot')[d].style.top) + 1 + 'px';
                if (parseInt(document.querySelectorAll('#npc_shot')[d].style.top) >= innerWidth + 100) {
                    document.querySelectorAll('#npc_shot')[d].remove();
                }
            }
        }



    }
    function playerMove() {
        if (!paused) {
            if (mouseCurPos - parseInt(player_hero.style.left) >= 200) {
                player_hero.style.left = parseInt(player_hero.style.left) + 4 + 'px';

            }
            if (mouseCurPos - parseInt(player_hero.style.left) >= 75 && mouseCurPos - parseInt(player_hero.style.left) < 200) {
                player_hero.style.left = parseInt(player_hero.style.left) + 3.5 + 'px';
            }
            if (mouseCurPos - parseInt(player_hero.style.left) >= 25 && mouseCurPos - parseInt(player_hero.style.left) < 75) {
                player_hero.style.left = parseInt(player_hero.style.left) + 2.5 + 'px';
            }
            if (mouseCurPos - parseInt(player_hero.style.left) >= 0 && mouseCurPos - parseInt(player_hero.style.left) < 25) {
                player_hero.style.left = parseInt(player_hero.style.left) + 1 + 'px';
            }
            if (mouseCurPos - parseInt(player_hero.style.left) <= -200) {
                player_hero.style.left = parseInt(player_hero.style.left) - 4 + 'px';
            }
            if (mouseCurPos - parseInt(player_hero.style.left) <= -75 && mouseCurPos - parseInt(player_hero.style.left) > -200) {
                player_hero.style.left = parseInt(player_hero.style.left) - 3.5 + 'px';
            }
            if (mouseCurPos - parseInt(player_hero.style.left) <= -25 && mouseCurPos - parseInt(player_hero.style.left) > -75) {
                player_hero.style.left = parseInt(player_hero.style.left) - 2.5 + 'px';
            }
            if (mouseCurPos - parseInt(player_hero.style.left) <= 0 && mouseCurPos - parseInt(player_hero.style.left) > -25) {
                player_hero.style.left = parseInt(player_hero.style.left) - 1 + 'px';
            }
        }
    }
    function diff() {
        console.log('уебище вызвало диф')
        if (!paused) {

            if (bot_diff < 1500) {
                clearInterval(timer_Npc_spawn);
                timer_Npc_spawn = setInterval(
                    bot_spawn
                    , 3000 - bot_diff);
                bot_diff += 150;
                document.querySelector('.innerlevel').innerHTML = 'level ' + LVLno;
                LVLno += 1;
            } else {
                clearInterval(timer_Npc_spawn);
                timer_Npc_spawn = setInterval(
                    bot_spawn
                    , 3000 - bot_diff);
                clearInterval(timer);

            }
        }

    }
    function botMove() {
        if (!paused) {
            for (let i = 0; i < document.querySelectorAll('#bot').length; i++) {
                document.querySelectorAll('#bot')[i].style.top = parseInt(document.querySelectorAll('#bot')[i].style.top) + 1 + 'px';
                if (parseInt(document.querySelectorAll('#bot')[i].style.top) >= innerHeight + 100) {
                    document.querySelectorAll('#bot')[i].remove();

                }
            }
        }
    }
    function createTimer() {

        console.log('уебище вызвало createtimer')
        filler = setInterval(() => {
            diffTime += 1;
            if (diffTime >= 9000) {
                diffTime = 0;
                if (timer == null) {
                    clearInterval(filler)
                }


            }
        }, 1);
        timer1 = setTimeout(() => {
            if (!paused) {
                clearInterval(filler)
                diff();
                startdifftimer()
            }

        }, 9000 - diffTime);



    }
    function pause() {
        if (!paused) {
            paused = true;
            pausewindow.style.display = 'block';
            playField.removeEventListener('click', bot_simple_attack)
            clearInterval(filler);
            clearInterval(timer);
            clearInterval(timer1);

            console.log(diffTime);

        }

    }
    function unpouse() {
        if (!!paused) {
            paused = false;
            pausewindow.style.display = 'none';
            playField.addEventListener('click', bot_simple_attack);
            createTimer();


        }

    }
    function startdifftimer() {
        if (!paused) {
            console.log('продолжил нормальный интервал')
            diffTime = 0;
            filler = setInterval(() => {
                diffTime += 1;
                if (diffTime == 9000) {
                    diffTime = 0;
                }
            }, 1);
            timer = setTimeout(() => {
                diff();
            }, 9000);
        }

    }
    function npcShotTimer() {
        if (!paused) {
            shottime = 0;
            shotfiller = setInterval(() => {
                shottime += 1;
                if (shottime == 2000) {
                    shottime = 0;
                }
            }, 1);
            timer_npc_shot = setInterval(() => {
                npc_shooting();
            }, 2000);
        }


    }
    function resumenpcshooting() {
        console.log('уебище вызвало createtimer')
        shotfiller = setInterval(() => {
            shottime += 1;
            if (shottime >= 2000) {
                shottime = 0;
                if (timer_npc_shot == null) {
                    clearInterval(shotfiller)
                }


            }
        }, 1);
        timer_npc_shot1 = setTimeout(() => {
            if (!paused) {
                clearInterval(shotfiller)
                npc_shooting();
                npcShotTimer()
            }

        }, 2000 - shottime);
    }
    let x = 450, y = 600;
    player_hero.style.left = x + 'px';
    player_hero.style.top = y + 'px';


    playField.addEventListener('click', bot_simple_attack)
    let timer_bot_Shot = setInterval(playerAttack, 3);
    window.addEventListener('mousemove', (event) => {
        mousePos = event.clientX;
        mouseCurPos = mousePos - 50;
    });
    let timer_fast_player_move = setInterval(playerMove, 2)
    timer_Npc_spawn = setInterval(
        bot_spawn
        , 3000);
    bot_diff += 150;
    startdifftimer();


    window.addEventListener('keydown', (e) => {
        switch (e.key) {
            case 'Escape': pause();
        }
    })
    npcShotTimer();

    let timer_npc_move = setInterval(botMove, 10)
    document.querySelector('.unpouse_button').addEventListener('click', unpouse)

    //if(botM.style.top==shotM.style.top && (botM.style.left>shotM.style.left+40)){
    //
    //}

    //let timer_bot_Shot = setInterval(() => { if (mousePos - parseInt(player_hero.style.left)>=4)
    //{
    //            let delaymove = setTimeout(()=>player_hero.style.left=parseInt(player_hero.style.left)+2+'px' , 1000)
    //        }
    //    }, 50)
    //botM=document.querySelector('#bot'), shotM=document.querySelector('#bot_shot')
    //timer_npc_shot = setInterval(npc_shooting, 2000);
</script>